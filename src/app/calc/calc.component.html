<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<mat-card>
    <mat-card-content>
                <div class="container flexbox">
                    <div>
                        <form id="htmlData" [formGroup]="formCalc">
                            <div class="flexbox">
                                <div><h2>CORREÇÃO MONETÁRIA</h2></div>
                                <div><button mat-button (click)="isActive = !isActive">
                                    <mat-icon>
                                        tips_and_updates
                                    </mat-icon>
                                </button>
                                </div>
                            </div>
                            <div class="flexbox">
                                <div fxLayoutGap="15px">
                                    <label>Tipo de cálculo</label>
                                    <mat-form-field appearance="outline">
                                        <mat-select formControlName="fcTipos">
                                            <!-- Nâo aparecer 6.899/81 -->
                                            <mat-option value="debitos">Débitos / Créditos entre particulares</mat-option>
                                            <mat-option value="tributado">Débitos contra fazenda pública - tributários</mat-option>
                                            <!-- Aparecer todos os índices -->
                                            <mat-option value="Ntributado">Débitos contra fazenda pública - não tributários</mat-option>
                                            <!-- Nâo aparecer 11.960/2009 -->
                                            <mat-option value="abatimentos">Abatimentos</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div>
                                    <label>Índice</label>
                                    <mat-form-field appearance="outline">
                                        <mat-select formControlName="fcIndiceLanca">
                                            <mat-option value="IPCA-E">IPCA-E</mat-option>
                                            <mat-option value="IGP-M">IGP-M</mat-option>
                                            <mat-option value="TR">TR</mat-option>
                                            <mat-option value="SELIC">SELIC</mat-option>
                                            <mat-option value="TJ11960" [hidden]="formCalc.controls.fcTipos.value == 'debitos'">
                                                TJ/RJ LEI 11.960/2009</mat-option>
                                            <mat-option value="TJ899" [hidden]="formCalc.controls.fcTipos.value == 'tributado'">
                                                TJ/RJ LEI 6.899/81</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="flexbox">
                                <div>
                                    <label for="valor">Valor</label>
                                    <mat-form-field appearance="outline">
                                        <input formControlName="fcValorLanca" matInput currencyMask
                                            [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }" />
                                    </mat-form-field>
                                </div>
                                <div class="flexbox">
                                    <div>
                                        <label for="dataDeInicio">Início</label>
                                        <mat-form-field appearance="outline">
                                        <input formControlName="fcDtIniLanca" matInput type="date" id="dataDeInicio"
                                            name="dataDeInicio" />
                                        </mat-form-field>
                                    </div>
                                    <div>
                                        <label for="dataDeTermino">Término</label>
                                        <mat-form-field appearance="outline">
                                        <input formControlName="fcDtFimLanca" matInput type="date" id="dataDeTermino"
                                            name="dataDeTermino" />
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <div  class="flexbox">
                                <div>
                                    <label>Incidir juros</label>
                                </div>
                                <div>
                                    <mat-slide-toggle color="warn" [(ngModel)]="ngmJuros" formControlName="FcJuros"></mat-slide-toggle>
                                </div>
                            </div>
                            <div  class="flexbox">
                                <mat-hint>Percentual de juros até 10/01/2003: 6% ao ano ou 0,5% ao mês.<BR /> Percentual de juros a partir de 10/01/2003 12% ao ano ou 1% ao mês </mat-hint>
                            </div>
                        </form>
                    </div>
                    <div class="ui-overlaypanel" [hidden]="!isActive">
                        <div class="header" class="mat-elevation-z8">
                            <h1>Lançamentos</h1>
                            <div class="separator"></div>
                        </div>
                        <div class="contente">
                            <div style="padding-top: 10px;">
                                Lançamentos podem ser de 2 tipos, lançamentos de crédito ou pagamento.
                            </div>
                            <div style="padding-top: 10px;">
                                Lançamentos de crédito correspondem aos valores oriundos de decisões judiciais, custas,
                                despesas etc, que eventualmente podem
                                ser corrigidas por um determinado período de tempo.
                            </div>
    
                        </div>
                    </div>
                </div>
                <div class="container flexbox">
                    <div>
                        <button	 mat-raised-button color="warn" (click)="addTbl()"
                           >Calcular <mat-icon>calculate</mat-icon>
                        </button>
                    </div>
                    <!--div>
                        <button mat-raised-button color="primary" style="background-color: rgb(0 0 0);" (click)="openPDF()">Detalhar cálculo
                            <mat-icon>visibility</mat-icon>
                        </button>
                    </div-->
                    <div>
                        <button mat-raised-button color="primary" style="background-color: #3099FF;" (click)="openPDF()">Relatório
                            <mat-icon>print</mat-icon>
                        </button>
                    </div>
                </div>
            <div class="container">
                <div class="">

                    <mat-table #table [dataSource]="dataSourceLanca" class="mat-elevation-z8">
                        <ng-container matColumnDef="select" class="coluna">
                            <mat-header-cell *matHeaderCellDef>
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row"> </mat-cell>
                            <mat-footer-cell *matFooterCellDef class="footerBold"></mat-footer-cell>
                        </ng-container>

                        <ng-container matColumnDef="delete" class="coluna">
                            <mat-header-cell *matHeaderCellDef class="coluna">Excluir
                            </mat-header-cell>
                            <mat-cell *matCellDef="let row">
                                <img src="/assets/imgs/icon_delete.svg" class="iconDeleteTab"
                                    title="Clique para excluir" (click)="$event.stopPropagation(); 
                                        $event ? selection.toggle(row) : null;
                                        selection.isSelected(row);
                                        removeSelectedRows('ServTec') ">
                            </mat-cell>
                            <mat-footer-cell *matFooterCellDef style="font-weight: bold;">Total</mat-footer-cell>
                        </ng-container>

                        <ng-container matColumnDef="position" class="coluna">
                            <mat-header-cell *matHeaderCellDef class="coluna"> Nº
                            </mat-header-cell>
                            <mat-cell *matCellDef="let element; let i = index"> {{i + 1}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                        </ng-container>

                        <ng-container matColumnDef="indice">
                            <mat-header-cell *matHeaderCellDef> Índice de correção monetária</mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.indice}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef class="footerBold"></mat-footer-cell>
                        </ng-container>

                        <ng-container matColumnDef="dtIni">
                            <mat-header-cell *matHeaderCellDef> Data Inicio </mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.dtIni | date: 'dd/MM/yyyy'}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                        </ng-container>

                        <ng-container matColumnDef="dtFim">
                            <mat-header-cell *matHeaderCellDef> Data Fim </mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.dtFim | date: 'dd/MM/yyyy'}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                        </ng-container>
                        <ng-container></ng-container>
                        <ng-container matColumnDef="dias">
                            <mat-header-cell *matHeaderCellDef> Dias </mat-header-cell>
                            <mat-cell *matCellDef="let element"> {{element.dias}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                        </ng-container>
                        <ng-container matColumnDef="juros" [hidden]="formCalc.controls.FcJuros.value == true">
                            <mat-header-cell *matHeaderCellDef> Juros </mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                {{element.juros| currency:'BRL'}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef></mat-footer-cell>
                        </ng-container>
                        <ng-container matColumnDef="valor">
                            <mat-header-cell *matHeaderCellDef> Valor </mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                {{element.valor | currency:'BRL'}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef style="font-weight: 700;">
                                {{this.SumTotalCorr  | currency:'BRL'}}</mat-footer-cell>
                        </ng-container>
                        <ng-container matColumnDef="valorCorr">
                            <mat-header-cell *matHeaderCellDef> Valor Total </mat-header-cell>
                            <mat-cell *matCellDef="let element;">
                                {{element.valorCorr | currency:'BRL'}} </mat-cell>
                            <mat-footer-cell *matFooterCellDef style="margin-left: -30%; font-weight: 700;">
                                {{this.SumTotal | currency:'BRL'}}</mat-footer-cell>
                        </ng-container>
                        <ng-container matColumnDef="noData">
                            <mat-footer-cell *matFooterCellDef [attr.colspan]="displayedColumnsLanc.length">
                                Nenhum lançamento calculado.
                            </mat-footer-cell>
                        </ng-container>
                        <ng-container matColumnDef="check" class="coluna">
                            <mat-header-cell *matHeaderCellDef class="coluna">
                            </mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <mat-icon class="iconValidTab" *ngIf="element.position > 0">done
                                </mat-icon>
                            </mat-cell>
                        </ng-container>
                        <!--

                        <ng-container matColumnDef="header-row-first-group">
                            <mat-header-cell *matHeaderCellDef 
                                [style.text-align]="center" [attr.colspan]="2">  </mat-header-cell>
                          </ng-container>
                          
                          
                          <ng-container matColumnDef="header-row-second-group">
                            <mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="margin-left: 40px;"> Second group </mat-header-cell>
                          </ng-container>
                        
                          <ng-container matColumnDef="header-row-tre-group">
                            <mat-header-cell *matHeaderCellDef [attr.colspan]="2"> Tree group </mat-header-cell>
                          </ng-container>
                           
                          <mat-header-row *matHeaderRowDef="['header-row-first-group', 'header-row-second-group','header-row-tre-group']"></mat-header-row>

                          <mat-footer-row  *matFooterRowDef="['select','delete','position','indice','dtIni','dtFim','dias','juros', 'valor','valorCorr']; sticky: true">
                          -->

                        <mat-header-row *matHeaderRowDef="displayedColumnsLanc"></mat-header-row>
                        <!--
                            <mat-footer-row *matFooterRowDef="['noData']" [hidden]="dataSourceLanca && dataSourceLanca.data.length > 0"></mat-footer-row>
                            <mat-footer-row  *matFooterRowDef="['select','delete','position','indice','dtIni','dtFim','dias','juros','valorCorr', 'valor']"></mat-footer-row>      
                            <mat-footer-row  *matFooterRowDef="['select','delete','juros','valorCorr', 'valor']"></mat-footer-row>      
                            <mat-footer-row  *matFooterRowDef="displayedColumnsLanc"></mat-footer-row>      
                        -->
                        <!-- <mat-footer-row  *matFooterRowDef="['select','delete','indice','juros','valorCorr', 'valor']; sticky: true" ></mat-footer-row>  -->
                        <mat-footer-row
                            *matFooterRowDef="['select','delete','position','dtFim','dias','juros','valorCorr', 'valor']; sticky: true">
                        </mat-footer-row>
                        <mat-footer-row *matFooterRowDef="['noData']"
                            [hidden]="dataSourceLanca && dataSourceLanca.data.length > 0"></mat-footer-row>

                        <mat-row *matRowDef="let row; columns: displayedColumnsLanc;" (click)="selection.toggle(row)">
                        </mat-row>
                    </mat-table>
                    <div>
                        <div>
                            <!--p>{{ datahoje }}</p-->
                        </div>
                    </div>
                </div>
            </div>
    </mat-card-content>

</mat-card>